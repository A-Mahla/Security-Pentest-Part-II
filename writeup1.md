# Writeup 1 - Main Challenge

<br>

## Step 0 - Find the iso ip

To start, you need to know the ip iso to connect to it. Since we've configured the VM to be in the local network,
we look at our network interfaces:
```shell
host:~$ ip a
...
3: vboxnet0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 0a:00:27:00:00:00 brd ff:ff:ff:ff:ff:ff
    inet 192.168.56.1/24 brd 192.168.56.255 scope global vboxnet0
       valid_lft forever preferred_lft forever
...
```
So we can deduce that the ip will be in range `192.168.56.2-255`, let's use `nmap` to find it !
```shell
host:~$ nmap 192.168.56.2-255
...
Nmap scan report for 192.168.56.7
Host is up (0.00019s latency).
Not shown: 994 closed tcp ports (conn-refused)
PORT    STATE SERVICE
21/tcp  open  ftp
22/tcp  open  ssh
80/tcp  open  http
143/tcp open  imap
443/tcp open  https
993/tcp open  imaps
...
```
Yes, We got it. So we can connect through the iso on ip `192.168.56.7`.

<br>

## Step 1 - find a vulnerable doorway.
Now, we know the ip and all open ports. Let's enumerate them:
<br>
-  `21` and `22` are respectively `ftp` and `ssh` ports and we don't have any credential so there aren't useful for the moment.
  
-  On port `80` (http port) we find an interesting information :

![http](images/http.png)

As we deduce the http/https ports might be the path we were expecting to enter the iso. We list the possible paths using `dirb`.

```shell
host:~$ dirb http://192.168.56.7
...
==> DIRECTORY: http://192.168.56.7/fonts/
+ http://192.168.56.7/forum (CODE:403|SIZE:285)                              
+ http://192.168.56.7/index.html (CODE:200|SIZE:1025)                        
+ http://192.168.56.7/server-status (CODE:403|SIZE:293)
...                     
```
We found nothing useful on `80` let's test the `443` port

```shell
host:~$ dirb https://192.168.56.7
...
==> DIRECTORY: https://192.168.56.7/forum/
==> DIRECTORY: https://192.168.56.7/phpmyadmin/
...                     
==> DIRECTORY: https://192.168.56.7/webmail/
...
```
Here we found that we expected, 3 possible doorway: phpmyadmin, webmail (both needed credentials) and ... a private forum with free access to topics !

![forum](images/forum.png)

<br>

# Step 2 - Inspect topics forum

by scrolling through the topics for a few minutes, we discover, in the topic `Problem login?`, a line which seems to be a password (`!q\]Ej?*5K5cy*AJ`) entered by mistake in place of a user login... and just after a success logon with the user `lmezard`:

```shell
Oct 5 08:45:27 BornToSecHackMe sshd[7547]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=161.202.39.38-static.reverse.softlayer.com
Oct 5 08:45:29 BornToSecHackMe sshd[7547]: Failed password for invalid user !q\]Ej?*5K5cy*AJ from 161.202.39.38 port 57764 ssh2
Oct 5 08:45:29 BornToSecHackMe sshd[7547]: Received disconnect from 161.202.39.38: 3: com.jcraft.jsch.JSchException: Auth fail [preauth]
Oct 5 08:46:01 BornToSecHackMe CRON[7549]: pam_unix(cron:session): session opened for user lmezard by (uid=1040)
Oct 5 09:21:01 BornToSecHackMe CRON[9111]: pam_unix(cron:session): session closed for user lmezard
```

Indeed, by testing, we found that it is the `lmezard`'s forum password!
by logging in with lizard's identifiers on the forum page, we now have access to lmezard's personal information,
and we will discover an email address: `laurie@borntosec.net` !

![email_forum](images/email_forum.png)

Now we have a mail, and we deduce that we can use it on a mail server... and there is one on on port `443` !
For the password, `laurie` isn't smart (like a good proportion of the humanity), she's reused the same password.
So, we connect to her mail.

![webmail](images/webmail.png)
